{"ast":null,"code":"import { UnixFS } from 'ipfs-unixfs';\nimport persist from '../../utils/persist.js';\nimport * as dagPb from '@ipld/dag-pb';\nimport * as raw from 'multiformats/codecs/raw';\n\nasync function* bufferImporter(file, block, options) {\n  for await (let buffer of file.content) {\n    yield async () => {\n      options.progress(buffer.length, file.path);\n      let unixfs;\n      const opts = {\n        codec: dagPb,\n        cidVersion: options.cidVersion,\n        hasher: options.hasher,\n        onlyHash: options.onlyHash\n      };\n\n      if (options.rawLeaves) {\n        opts.codec = raw;\n        opts.cidVersion = 1;\n      } else {\n        unixfs = new UnixFS({\n          type: options.leafType,\n          data: buffer,\n          mtime: file.mtime,\n          mode: file.mode\n        });\n        buffer = dagPb.encode({\n          Data: unixfs.marshal(),\n          Links: []\n        });\n      }\n\n      return {\n        cid: await persist(buffer, block, opts),\n        unixfs,\n        size: buffer.length\n      };\n    };\n  }\n}\n\nexport default bufferImporter;","map":{"version":3,"sources":["/Users/g2musicgroup/Developer/NFT-starter/filecoin_nft_starter-main/node_modules/ipfs-unixfs-importer/esm/src/dag-builder/file/buffer-importer.js"],"names":["UnixFS","persist","dagPb","raw","bufferImporter","file","block","options","buffer","content","progress","length","path","unixfs","opts","codec","cidVersion","hasher","onlyHash","rawLeaves","type","leafType","data","mtime","mode","encode","Data","marshal","Links","cid","size"],"mappings":"AAAA,SAASA,MAAT,QAAuB,aAAvB;AACA,OAAOC,OAAP,MAAoB,wBAApB;AACA,OAAO,KAAKC,KAAZ,MAAuB,cAAvB;AACA,OAAO,KAAKC,GAAZ,MAAqB,yBAArB;;AACA,gBAAgBC,cAAhB,CAA+BC,IAA/B,EAAqCC,KAArC,EAA4CC,OAA5C,EAAqD;AACnD,aAAW,IAAIC,MAAf,IAAyBH,IAAI,CAACI,OAA9B,EAAuC;AACrC,UAAM,YAAY;AAChBF,MAAAA,OAAO,CAACG,QAAR,CAAiBF,MAAM,CAACG,MAAxB,EAAgCN,IAAI,CAACO,IAArC;AACA,UAAIC,MAAJ;AACA,YAAMC,IAAI,GAAG;AACXC,QAAAA,KAAK,EAAEb,KADI;AAEXc,QAAAA,UAAU,EAAET,OAAO,CAACS,UAFT;AAGXC,QAAAA,MAAM,EAAEV,OAAO,CAACU,MAHL;AAIXC,QAAAA,QAAQ,EAAEX,OAAO,CAACW;AAJP,OAAb;;AAMA,UAAIX,OAAO,CAACY,SAAZ,EAAuB;AACrBL,QAAAA,IAAI,CAACC,KAAL,GAAaZ,GAAb;AACAW,QAAAA,IAAI,CAACE,UAAL,GAAkB,CAAlB;AACD,OAHD,MAGO;AACLH,QAAAA,MAAM,GAAG,IAAIb,MAAJ,CAAW;AAClBoB,UAAAA,IAAI,EAAEb,OAAO,CAACc,QADI;AAElBC,UAAAA,IAAI,EAAEd,MAFY;AAGlBe,UAAAA,KAAK,EAAElB,IAAI,CAACkB,KAHM;AAIlBC,UAAAA,IAAI,EAAEnB,IAAI,CAACmB;AAJO,SAAX,CAAT;AAMAhB,QAAAA,MAAM,GAAGN,KAAK,CAACuB,MAAN,CAAa;AACpBC,UAAAA,IAAI,EAAEb,MAAM,CAACc,OAAP,EADc;AAEpBC,UAAAA,KAAK,EAAE;AAFa,SAAb,CAAT;AAID;;AACD,aAAO;AACLC,QAAAA,GAAG,EAAE,MAAM5B,OAAO,CAACO,MAAD,EAASF,KAAT,EAAgBQ,IAAhB,CADb;AAELD,QAAAA,MAFK;AAGLiB,QAAAA,IAAI,EAAEtB,MAAM,CAACG;AAHR,OAAP;AAKD,KA7BD;AA8BD;AACF;;AACD,eAAeP,cAAf","sourcesContent":["import { UnixFS } from 'ipfs-unixfs';\nimport persist from '../../utils/persist.js';\nimport * as dagPb from '@ipld/dag-pb';\nimport * as raw from 'multiformats/codecs/raw';\nasync function* bufferImporter(file, block, options) {\n  for await (let buffer of file.content) {\n    yield async () => {\n      options.progress(buffer.length, file.path);\n      let unixfs;\n      const opts = {\n        codec: dagPb,\n        cidVersion: options.cidVersion,\n        hasher: options.hasher,\n        onlyHash: options.onlyHash\n      };\n      if (options.rawLeaves) {\n        opts.codec = raw;\n        opts.cidVersion = 1;\n      } else {\n        unixfs = new UnixFS({\n          type: options.leafType,\n          data: buffer,\n          mtime: file.mtime,\n          mode: file.mode\n        });\n        buffer = dagPb.encode({\n          Data: unixfs.marshal(),\n          Links: []\n        });\n      }\n      return {\n        cid: await persist(buffer, block, opts),\n        unixfs,\n        size: buffer.length\n      };\n    };\n  }\n}\nexport default bufferImporter;"]},"metadata":{},"sourceType":"module"}